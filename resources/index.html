<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Security-Policy" content="
        default-src
            'self'
            'unsafe-inline'
            https://cdnjs.cloudflare.com
            https://airplane.mywire.org
            https://lancard.github.io
            https://github.com
            https://api.github.com
            https://raw.githubusercontent.com;
         script-src
            'self'
            'unsafe-inline'
            https://cdnjs.cloudflare.com;">
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>K-Installer</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/startbootstrap-sb-admin-2/4.1.4/css/sb-admin-2.min.css"
        integrity="sha512-Mk4n0eeNdGiUHlWvZRybiowkcu+Fo2t4XwsJyyDghASMeFGH6yUXcdDI3CKq12an5J8fq4EFzRVRdbjerO3RmQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="style.css" />

    <!-- for loading jQuery -->
    <script>
        if (typeof module === 'object') { window.module = module; module = undefined; }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js"
        integrity="sha512-pumBsjNRGGqkPzKHndZMaAG+bir374sORyzM3uulLV14lN5LyykqNk8eEeUlUkB3U0M4FApyaHraT65ihJhDpQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.11.7/dayjs.min.js"
        integrity="sha512-hcV6DX35BKgiTiWYrJgPbu3FxS6CsCjKgmrsPRpUPkXWbvPiKxvSVSdhWX0yXcPctOI2FJ4WP6N1zH+17B/sAA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- for loading jQuery -->
    <script>
        if (window.module) module = window.module;
    </script>
</head>

<body>
    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Sidebar -->
        <ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="sidebar">

            <!-- Sidebar - Brand -->
            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="javascript: void(0)"
                onclick="showMenu('home')">
                <div class="sidebar-brand-icon rotate-n-15">
                    <i class="fas fa-plane"></i>
                </div>
                <div class="sidebar-brand-text mx-3" style="font-family: 'FontAwesome';">K-Installer</div>
            </a>

            <!-- Divider -->
            <hr class="sidebar-divider d-none d-md-block">

            <!-- Heading -->
            <div class="sidebar-heading mb-2 mt-4">
                <i class="fas fa-fw fa-tree"></i> Scenery and Chart
            </div>

            <li class="nav-item">
                <a class="nav-link" href="javascript: void(0)" onclick="showMenu('RKJY')">
                    <span class="font-weight-bold">RKJY</span>
                    <small class="d-none d-lg-inline"> Yeosu airport</small>
                    <span updateIcon="RKJY" class="d-none" update-mark-RKJY-fs2020-scenery update-mark-RKJY-p3d-scenery>
                        <sup class="text-warning">up<i class="fas fa-turn-up text-warning"></i></sup>
                    </span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="javascript: void(0)" onclick="showMenu('RKPK')">
                    <span class="font-weight-bold">RKPK</span>
                    <small class="d-none d-lg-inline"> Gimhae airport</small>
                    <span updateIcon="RKPK" class="d-none">
                        <sup class="text-warning">up<i class="fas fa-turn-up text-warning"></i></sup>
                    </span>
                </a>
            </li>

            <!-- Heading -->
            <div class="sidebar-heading mb-2 mt-4">
                <i class="fas fa-fw fa-wand-magic-sparkles"></i> ATC Program
            </div>
            <li class="nav-item">
                <a class="nav-link" href="javascript: void(0)" onclick="showMenu('KRW')">
                    <span class="font-weight-bold">KRW</span>
                    <small class="d-none d-lg-inline"> Korean weather radar</small>
                    <span updateIcon="KRW" class="d-none">
                        <sup class="text-warning">up<i class="fas fa-turn-up text-warning"></i></sup>
                    </span>
                </a>
            </li>

            <!-- Divider -->
            <div class="bottom-copyright">
                <hr class="sidebar-divider d-none d-md-block" style="margin-top: 40px;">

                <li class="nav-item">
                    <a class="nav-link" href="javascript:void(0)" role="button"
                        onclick="alert('w_o_r_s_t_r_o_c_k_e_r@gmail.com plz. (delete underscore before send)')">
                        <i class="fas fa-envelope fa-fw"></i>
                        <span class="mx-2">Email to me</span>
                    </a>
                </li>

                <!-- Nav Item - Github -->
                <li class="nav-item dropdown no-arrow mx-1">
                    <a class="nav-link dropdown-toggle" href="javascript:void(0)" id="messagesDropdown" role="button"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                        onclick="require('child_process').execSync('start https://github.com/lancard')">
                        <i class="fa-brands fa-github"></i>
                        <span class="mx-2">Github Link</span>
                    </a>
                </li>

                <li class="nav-item dropdown no-arrow mx-1 my-4 text-center">
                    <small><span>Copyright &copy; Sungho Kim 2023</span></small>
                </li>
            </div>
        </ul>
        <!-- End of Sidebar -->

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column p-2">

            <!-- Main Content -->
            <div id="content">

                <!-- start of container-->
                <div class="container-fluid collapse" id="KRW">
                    <div class="m-1">
                        <h2 class="m-2">
                            <i class="fa-solid fa-plane-departure"></i>
                            KRW - Euroscope plugin Korean Radar for Weather
                        </h2>
                    </div>

                    <div class="row p-4">
                        <div class="col-auto">
                            <img src="https://lancard.github.io/k-installer/KRW.png" width="400" class="m-1"
                                style="box-shadow: 5px 5px 10px #000; border-radius: 25px;">
                        </div>
                        <div class="col mx-0 my-4">
                            <h4>How to install</h4>
                            <ul class="airport-description">
                                <li>Download & Unzip downloaded file</li>
                                <li>Run euroscope and menu - plugin</li>
                                <li>Load dll</li>
                            </ul>
                            <div class="mx-4">
                                <button type="button" class="btn btn-primary mx-2"
                                    onclick="updateScenery2020('RKJY', 'master')">Install / Update</button>
                                <button type="button" class="btn btn-danger mx-2"
                                    onclick="removeScenery2020('RKJY')">Remove</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- end of container -->


                <!-- start of airport container -->
                <div class="container-fluid collapse" id="RKSI"></div>
                <div class="container-fluid collapse" id="RKJY"></div>
                <!-- end of airport container -->


                <div class="container-fluid" id="home">
                    <div class="m-1">
                        <h2 class="m-2">
                            <i class="fa-solid fa-wand-magic-sparkles"></i>
                            Welcome to Korea Program and Scenery Installer
                        </h2>
                    </div>

                    <div class="row p-4">
                        <div class="col-auto">
                            <img src="https://lancard.github.io/k-installer/airport.png"
                                style="box-shadow: 5px 5px 10px #000; border-radius: 25px; width: 30vw;">

                            <div class="map-overlay" onclick="showMenu('RKJY')" style="top: 36.2vw; left: 14vw;">
                                <div class="bg-gray-800"><i class="fa-solid fa-plane"></i> RKJY</div>
                                <hr class="m-0" style="border-color: white;">
                                <div>Yeosu</div>
                            </div>
                            <div class="map-overlay" onclick="showMenu('RKPK')" style="top: 34.2vw; left: 20vw;">
                                <div class="bg-gray-800"><i class="fa-solid fa-plane"></i> RKPK</div>
                                <hr class="m-0" style="border-color: white;">
                                <div>Gimhae</div>
                            </div>
                        </div>
                        <div class="col">
                            <div downloadStatusProgram class="collapse m-4 p-4 bg-dark">
                                <h2 statusMessage class="text-primary">Download in progress...</h2>
                                <h4>Download: <span transferred>0</span></h4>
                                <h4>Speed: <span speed>0</span> MB/s</h4>
                            </div>

                            <div class="card m-4">
                                <div class="card-header">
                                    <i class="fa-solid fa-people-carry-box"></i> Installer Version
                                </div>
                                <div class="card-body">
                                    <span id="programVersion">(Loading)</span>
                                </div>
                            </div>

                            <div class="card m-4">
                                <div class="card-header">
                                    <i class="fa-solid fa-people-carry-box"></i> FS2020 Community Folder
                                </div>
                                <div class="card-body">
                                    <span id="communityDirectory">(Loading)</span>
                                    <button type="button" class="btn btn-primary mx-4 p-2"
                                        onclick="require('child_process').execSync('explorer '+communityDirectory);">Open
                                        in explorer</button>
                                </div>
                            </div>
                        </div>
                    </div>



                </div>

            </div>
        </div>

    </div>



    <!-- airport template -->
    <!-- airport template -->
    <!-- airport template -->
    <!-- airport template -->
    <!-- airport template -->
    <!-- airport template -->
    <!-- airport template -->
    <!-- airport template -->
    <!-- airport template -->
    <!-- airport template -->
    <!-- airport template -->
    <!-- airport template -->
    <!-- airport template -->
    <!-- airport template -->
    <div airportTemplate class="collapse">
        <div class="m-1">
            <h2 class="m-2">
                <i class="fa-solid fa-plane-departure"></i>
                <span icao></span> - <span airportName></span>
            </h2>
        </div>

        <div class="row p-4">
            <div class="col-auto">
                <img airportImage src="" width="400" class="m-1"
                    style="box-shadow: 5px 5px 10px #000; border-radius: 25px;">
            </div>
            <div class="col mx-0 my-4">
                <ul class="airport-description">
                    <li>ICAO: <strong icao></strong></li>
                    <li>NAME: <strong airportName></strong></li>
                    <li>METAR: <strong class="text-warning" metarArea></strong></li>
                </ul>
            </div>
        </div>

        <hr />

        <h4 class="mx-4">
            <i class="fa-solid fa-tree"></i> Charts
        </h4>

        <div class="row mx-4" chartArea></div>

        <hr />

        <h4 class="mx-4">
            <i class="fa-solid fa-tree"></i> Scenery
        </h4>
        <div class="row mx-4">
            <div class="col">
                <div class="card" sceneryType="fs2020">
                    <div class="card-header">
                        <i class="fa-solid fa-people-carry-box"></i> FS2020
                    </div>
                    <div class="card-body text-center">
                        <ul class="airport-description text-left">
                            <li>Author: <strong author></strong></li>
                            <li>License: <strong license></strong></li>
                            <li>Latest version: <strong latestVersion="RKJY-fs2020-scenery"></strong></li>
                            <li>Installed version: <strong installedVersion="RKJY-fs2020-scenery"></strong>
                            </li>
                            <li>Installed directory: <span class="text-small text-white"
                                    installedDirectory="RKJY-fs2020-scenery"></span>
                            </li>
                        </ul>

                        <button downloadButton="RKJY-fs2020-scenery" type="button" class="btn btn-primary mx-2"
                            onclick="upgradeProgram('RKJY-fs2020-scenery')">Install / Update</button>
                        <button downloadButton="RKJY-fs2020-scenery" type="button" class="btn btn-danger mx-2"
                            onclick="removeProgram('RKJY-fs2020-scenery')">Remove</button>
                        <div downloadStatus="RKJY-fs2020-scenery" class="collapse">
                            <h4 statusMessage class="text-primary">Download in progress...</h4>
                            <h4>Download: <span transferred>0</span></h4>
                            <h4>Speed: <span speed>0</span> MB/s</h4>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col">
                <div class="card" sceneryType="p3d">
                    <div class="card-header">
                        <i class="fa-solid fa-people-carry-box"></i> FSX/P3D
                    </div>
                    <div class="card-body text-center">
                        <ul class="airport-description text-left">
                            <li>Author: <strong>VFR GO!</strong></li>
                            <li>License: <strong>contact VFR GO!</strong></li>
                            <li>Latest version: <strong latestVersion="RKJY-p3d-scenery"></strong></li>
                            <li>Installed version: <strong installedVersion="RKJY-p3d-scenery"></strong>
                            </li>
                            <li>Installed directory: <span class="text-small text-white"
                                    installedDirectory="RKJY-p3d-scenery"></span>
                            </li>
                        </ul>

                        <button downloadButton="RKJY-p3d-scenery" type="button" class="btn btn-primary mx-2"
                            onclick="upgradeProgram('RKJY-p3d-scenery')">Install specific directory</button>
                        <button downloadButton="RKJY-p3d-scenery" type="button" class="btn btn-danger mx-2"
                            onclick="removeProgram('RKJY-p3d-scenery')">Remove</button>

                        <div downloadStatus="RKJY-p3d-scenery" class="collapse">
                            <h4 statusMessage class="text-primary">Download in progress...</h4>
                            <h4>Download: <span transferred>0</span></h4>
                            <h4>Speed: <span speed>0</span> MB/s</h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="common.js"></script>
    <script>
        function openChart(elem, chartName) {
            var icao = $(elem).parents("div[airportTemplate]").attr("icao");

            window.open(`https://lancard.github.io/chart/AIP/latest/AD/${icao}/${chartName}.pdf`);
        }

        function createSceneryContentsDOM(icao, airportName, chartMap, metar, fs2020Id, p3dId) {
            $clonedDOM = $("[airportTemplate]:not(:visible)").clone().removeClass("collapse");

            // common
            $clonedDOM.attr("icao", icao);
            $clonedDOM.find("[icao]").text(icao);
            $clonedDOM.find("[airportName]").text(airportName);
            $clonedDOM.find("[airportImage]").attr("src", `https://lancard.github.io/k-installer/${icao}.png`);

            // metar
            $clonedDOM.find("[metarArea]").text(metar);

            // charts
            for (var chartType in chartMap) {
                if (!chartMap[chartType])
                    continue;

                $(`<button type="button" class="btn btn-info m-2" onclick="openChart(this, '${chartType}')">${chartType}</button>`).appendTo($clonedDOM.find("[chartArea]"));
            }


            // fs2020
            $clonedDOM.find("[sceneryType=fs2020]").find("[author]").text(programInfo[fs2020Id].author);
            $clonedDOM.find("[sceneryType=fs2020]").find("[license]").text(programInfo[fs2020Id].license);


            $clonedDOM.appendTo("#RKJY");
        }

        initialization();

        $.getJSON("https://airplane.mywire.org/metar.json", metar => {
            // https://lancard.github.io/chart/AIP/latest/AD/chartInformation.json
            $.getJSON('https://raw.githubusercontent.com/lancard/chart/main/AIP/latest/AD/chartInformation.json', (data) => {
                createSceneryContentsDOM("RKJY", "Yeosu airport", data["RKJY"], metar["RKJY"].metar, "RKJY-fs2020-scenery", "RKJY-p3d-scenery");
            });
        });
    </script>
</body>

</html>